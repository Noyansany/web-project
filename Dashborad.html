<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI KPI RAG Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg:#f0f4f8;
  --card:#ffffffcc;
  --text:#1e293b;
  --primary:#6366f1;
  --success:#22c55e;
  --warning:#f59e0b;
  --danger:#ef4444;
}
body.dark{
  --bg:#0f172a;
  --card:rgba(31,41,55,.9);
  --text:#e5e7eb;
}
*{box-sizing:border-box;font-family:Inter;margin:0;padding:0;}
body{
  background:linear-gradient(135deg,var(--bg),#dbeafe);
  color:var(--text);
  padding:10px;
}
h1{
  text-align:center;
  margin-bottom:20px;
  background:linear-gradient(90deg,#4f46e5,#6366f1);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.toggle{
  position:fixed;top:10px;right:10px;
  background:var(--primary);color:#fff;
  border:none;border-radius:999px;
  padding:8px 14px;cursor:pointer;
}
.container{
  background:var(--card);
  backdrop-filter:blur(12px);
  border-radius:16px;
  padding:20px;
  max-width:1400px;
  margin:auto;
}
.kpi{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:15px;
  margin-bottom:20px;
}
.kpi .card{
  background:#fff;
  padding:15px;
  border-radius:16px;
  text-align:center;
  box-shadow:0 10px 20px rgba(0,0,0,.08);
}
.inputs{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  gap:10px;
  margin-bottom:15px;
}
input,select{
  padding:8px;border-radius:10px;border:none;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}
button.add{
  background:var(--success);
  color:#fff;border:none;
  padding:10px;border-radius:12px;
  cursor:pointer;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
  font-size:13px;
}
th,td{padding:8px;text-align:center}
th{background:var(--primary);color:#fff}
tbody tr:hover{background:rgba(99,102,241,.05)}
.badge.ok{background:#22c55e33;color:#16a34a;padding:4px 10px;border-radius:10px}
.badge.amber{background:#facc1533;color:#b45309;padding:4px 10px;border-radius:10px}
.badge.bad{background:#ef444433;color:#b91c1c;padding:4px 10px;border-radius:10px}
button.edit{
 background:#6366f1;color:#fff;border:none;
 padding:4px 8px;border-radius:8px;cursor:pointer;
}
button.del{
 background:#ef4444;color:#fff;border:none;
 padding:4px 8px;border-radius:8px;cursor:pointer;
}
.charts{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:20px;margin-top:20px;
}
@media(max-width:900px){.charts{grid-template-columns:1fr}}
</style>
</head>

<body>

<button class="toggle" onclick="toggleTheme()">üåô / ‚òÄ</button>
<h1>üìä Modern KPI RAG Dashboard</h1>

<div class="container">

<div class="kpi">
 <div class="card"><h3>Total Target</h3><p id="kpiTarget">0</p></div>
 <div class="card"><h3>Total Achieved</h3><p id="kpiAch">0</p></div>
 <div class="card"><h3>Achievement %</h3><p id="kpiPct">0%</p></div>
 <div class="card"><h3>Best Zone</h3><p id="kpiZone">-</p></div>
 <div class="card"><h3>Best Shift</h3><p id="kpiShift">-</p></div>
</div>

<div class="inputs">
<input type="date" id="date">
<input placeholder="Employee ID" id="emp">
<select id="team"><option>Team-A</option><option>Team-B</option></select>
<select id="zone"><option>Zone-01</option><option>Zone-02</option></select>
<select id="shift"><option>Day</option><option>Evening</option></select>
<input type="number" id="mp" placeholder="Manpower">
<input type="number" id="hr" placeholder="Hours">
<input type="number" id="fridge" placeholder="Fridge">
<input type="number" id="ac" placeholder="AC">
<button class="add" onclick="addData()">‚ûï Add</button>
</div>

<table>
<thead>
<tr>
<th>Date</th><th>Emp</th><th>Team</th><th>Zone</th><th>Shift</th>
<th>Target</th><th>Achieved</th><th>%</th><th>Status</th><th>Action</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<div class="charts">
<canvas id="teamChart"></canvas>
<canvas id="zoneChart"></canvas>
</div>

</div>

<script>
const RATE=3;
const KEY="kpi_dashboard";
let teamChart, zoneChart;

function data(){return JSON.parse(localStorage.getItem(KEY)||"[]")}
function save(d){localStorage.setItem(KEY,JSON.stringify(d))}

function addData(){
 let d=data();
 let target=(+mp.value||0)*(+hr.value||0)*RATE;
 let achieved=(+fridge.value||0)+(+ac.value||0);
 d.push({date:date.value,emp:emp.value,team:team.value,zone:zone.value,shift:shift.value,target,achieved});
 save(d); render();
}

function deleteRow(i){
 if(!confirm("Delete this row?")) return;
 let d=data(); d.splice(i,1); save(d); render();
}

function editRow(i){
 let d=data(); let r=d[i];
 date.value=r.date; emp.value=r.emp; team.value=r.team;
 zone.value=r.zone; shift.value=r.shift;
 fridge.value=r.achieved; ac.value=0;
 d.splice(i,1); save(d); render();
}

function getBadge(p){
 if(p>=100) return "ok";
 if(p>=80) return "amber";
 return "bad";
}

function render(){
 let d=data(),tb=tableBody;
 tb.innerHTML="";
 let totalT=0,totalA=0,teamSum={},zoneSum={};

 d.forEach((r,i)=>{
  let pct=r.target?(r.achieved/r.target*100):0;
  tb.innerHTML+=`
  <tr>
   <td>${r.date}</td><td>${r.emp}</td><td>${r.team}</td>
   <td>${r.zone}</td><td>${r.shift}</td>
   <td>${r.target}</td><td>${r.achieved}</td>
   <td>${pct.toFixed(1)}%</td>
   <td><span class="badge ${getBadge(pct)}">${pct>=100?'Achieved':pct>=80?'Amber':'Pending'}</span></td>
   <td>
    <button class="edit" onclick="editRow(${i})">‚úèÔ∏è</button>
    <button class="del" onclick="deleteRow(${i})">üóëÔ∏è</button>
   </td>
  </tr>`;
  totalT+=r.target; totalA+=r.achieved;
  teamSum[r.team]=(teamSum[r.team]||0)+r.achieved;
  zoneSum[r.zone]=(zoneSum[r.zone]||0)+r.achieved;
 });

 kpiTarget.innerText=totalT;
 kpiAch.innerText=totalA;
 kpiPct.innerText=totalT?((totalA/totalT)*100).toFixed(1)+"%":"0%";

 drawChart(teamChart,teamChartEl,Object.keys(teamSum),Object.values(teamSum));
 drawChart(zoneChart,zoneChartEl,Object.keys(zoneSum),Object.values(zoneSum));
}

function drawChart(chart,el,lbl,data){
 if(chart) chart.destroy();
 return new Chart(el,{type:'bar',data:{labels:lbl,datasets:[{label:'Achieved',data,backgroundColor:'#22c55e'}]}});
}

function toggleTheme(){
 document.body.classList.toggle("dark");
}

date.value=new Date().toISOString().split("T")[0];
const teamChartEl=document.getElementById("teamChart");
const zoneChartEl=document.getElementById("zoneChart");
render();
</script>

</body>
</html>
